# Inspire Hand æ§åˆ¶ç³»ç»Ÿ

> **ğŸš€ æœ€æ–°æ›´æ–° (2025-08-01)**: å®ŒæˆåŸºäºIsaac Labå®˜æ–¹æ¶æ„çš„Warp GPUåŠ é€ŸçŠ¶æ€æœºé‡å†™ï¼

## ğŸ¯ **å¿«é€Ÿå¯åŠ¨**

### çŠ¶æ€æœºæ¨¡å¼ (æ¨è)
```bash
# çº¯çŠ¶æ€æœºè‡ªåŠ¨æŠ“å– (æ— éœ€æ‘„åƒå¤´)
./run_state_machine.sh

# æ— å¤´æ¨¡å¼æµ‹è¯•
./run_state_machine.sh --headless

# å¤šç¯å¢ƒå¹¶è¡Œ
./run_state_machine.sh --num_envs 4
```

### MediaPipeæ‰‹åŠ¿æ§åˆ¶æ¨¡å¼
```bash
# æ‰‹åŠ¿æ§åˆ¶æŠ“å– (éœ€è¦æ‘„åƒå¤´)
./run_with_mediapipe.sh
```

## âœ¨ **æ ¸å¿ƒç‰¹æ€§**

### ğŸ¤– **Warp GPUåŠ é€ŸçŠ¶æ€æœº** (æœ€æ–°)
- **åŸºäº**: Isaac Labå®˜æ–¹lift_cube_sm.pyæ¶æ„
- **çŠ¶æ€åºåˆ—**: REST â†’ APPROACH_ABOVE â†’ APPROACH â†’ GRASP â†’ LIFT
- **æŠ€æœ¯æ ˆ**: Warpå†…æ ¸GPUå¹¶è¡Œ + è·ç¦»é˜ˆå€¼æ£€æµ‹ + çœŸå®ä½ç½®æ§åˆ¶
- **æ”¯æŒ**: å¤šç¯å¢ƒå¹¶è¡Œï¼Œå®æ—¶çŠ¶æ€å¯è§†åŒ–

### ğŸ® **åŒæ§åˆ¶æ¨¡å¼**
1. **çŠ¶æ€æœºæ¨¡å¼**: è‡ªåŠ¨cubeæŠ“å–æ¼”ç¤ºï¼Œæ— éœ€äººå·¥å¹²é¢„
2. **MediaPipeæ¨¡å¼**: å®æ—¶æ‰‹åŠ¿æ˜ å°„æ§åˆ¶ï¼Œè‡ªç„¶äº¤äº’

### ğŸ”¬ **1061ä¼ æ„Ÿå™¨é›†æˆ** (å‡†å¤‡å°±ç»ª)
- 17ä¸ªä¼ æ„Ÿå™¨ç»„ï¼Œæ€»è®¡1061ä¸ªè§¦è§‰pad
- æç²¾ç»†çš„åŠ›æ„ŸçŸ¥å’Œæ¥è§¦æ£€æµ‹
- ä¸Isaac Labå®Œç¾é›†æˆ

## ğŸ“ **é¡¹ç›®ç»“æ„**

### ğŸ¯ **ä¸»è¦æ‰§è¡Œæ–‡ä»¶**
```
lift_cube_inspire_hand_state_machine.py  # Warp GPUçŠ¶æ€æœº (é‡å†™ç‰ˆ)
lift_cube_inspire_hand_with_mediapipe.py # MediaPipeæ‰‹åŠ¿æ§åˆ¶
run_state_machine.sh                     # çŠ¶æ€æœºå¯åŠ¨è„šæœ¬
run_with_mediapipe.sh                    # æ‰‹åŠ¿æ§åˆ¶å¯åŠ¨è„šæœ¬
```

### ğŸ“‹ **æŠ€æœ¯æ–‡æ¡£**
```
project_status.md                        # æœ€æ–°é¡¹ç›®çŠ¶æ€å’Œé—®é¢˜
inspire_hand_isaac_lab_integration_summary.txt  # æŠ€æœ¯æ¶æ„æ€»ç»“
test_results_summary.md                 # æµ‹è¯•ç»“æœè®°å½•
```

### âš™ï¸ **é…ç½®å’Œå·¥å…·**
```
inspire_hand_controller.py              # åŸå§‹æ§åˆ¶å™¨
mp_read_hand.py                         # MediaPipeæ‰‹åŠ¿è¯†åˆ«
hand_landmarker.task                    # MediaPipeæ¨¡å‹æ–‡ä»¶
```

## ğŸš§ **å½“å‰çŠ¶æ€ & å¾…è§£å†³é—®é¢˜**

### âœ… **å·²å®Œæˆ**
- [x] åŸºäºå®˜æ–¹lift_cube_sm.pyçš„çŠ¶æ€æœºé‡å†™
- [x] Warp GPUåŠ é€Ÿçš„å¹¶è¡Œå¤„ç†
- [x] 5çŠ¶æ€æŠ“å–åºåˆ—å®ç°
- [x] FrameTransformerç«¯æ‰§è¡Œå™¨è·Ÿè¸ª
- [x] è·ç¦»é˜ˆå€¼çŠ¶æ€è½¬æ¢
- [x] APIå…¼å®¹æ€§é—®é¢˜ä¿®å¤

### âš ï¸ **å½“å‰é—®é¢˜**
- [ ] **CUDAé©±åŠ¨å¼‚å¸¸**: `CUDA error 999: unknown error`
  - **çŠ¶æ€**: GPUæ˜¾ç¤ºç©ºé—²ï¼Œä½†Isaac Labæ— æ³•åˆå§‹åŒ–CUDA
  - **å»ºè®®**: ç³»ç»Ÿé‡å¯åé‡æ–°æµ‹è¯•

### ğŸ“‹ **ä¸‹æ¬¡æµ‹è¯•è®¡åˆ’**
1. **ç¡®è®¤CUDAçŠ¶æ€**: `nvidia-smi`
2. **æµ‹è¯•çŠ¶æ€æœº**: `./run_state_machine.sh --headless`
3. **éªŒè¯æŠ“å–åŠŸèƒ½**: è§‚å¯Ÿ5çŠ¶æ€åºåˆ—æ˜¯å¦æ­£å¸¸æ‰§è¡Œ
4. **æ€§èƒ½è°ƒä¼˜**: è°ƒæ•´é˜ˆå€¼å’Œç­‰å¾…æ—¶é—´å‚æ•°

è¿™æ˜¯ä¸€ä¸ªç”¨äºæ§åˆ¶Inspireçµå·§æ‰‹çš„ç»¼åˆè½¯ä»¶åŒ…ï¼Œæ”¯æŒå¤šç§æ§åˆ¶æ–¹å¼å’ŒåŠŸèƒ½ã€‚è¯¥é¡¹ç›®é›†æˆäº†æ‰‹éƒ¨å§¿æ€æ£€æµ‹ã€è¿œç¨‹æ“ä½œã€è§¦è§‰ä¼ æ„Ÿå™¨æ•°æ®å¯è§†åŒ–ä»¥åŠIsaac Labä»¿çœŸç­‰åŠŸèƒ½ã€‚

## é¡¹ç›®æ¦‚è¿°

Inspire Handæ˜¯ä¸€ä¸ªå¤šæŒ‡çµå·§æ‰‹ï¼Œå…·æœ‰6ä¸ªè‡ªç”±åº¦ï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼è¿›è¡Œæ§åˆ¶ï¼š
- Modbus TCPç½‘ç»œé€šä¿¡
- ä¸²å£é€šä¿¡  
- æ‰‹åŠ¿è¯†åˆ«é¥æ“ä½œ
- ROSä»¿çœŸæ§åˆ¶

## ä¸»è¦åŠŸèƒ½æ¨¡å—

### 1. åŸºç¡€æ§åˆ¶æ¨¡å—

#### `inspire_hand_controller.py`
- å®Œæ•´çš„Inspireæ‰‹éƒ¨æ§åˆ¶å™¨ç±»
- åŸºäºçŠ¶æ€æœºçš„æ§åˆ¶é€»è¾‘
- æ”¯æŒè‡ªåŠ¨é”™è¯¯æ£€æµ‹å’ŒçŠ¶æ€ç›‘æ§
- æä¾›æ ‡å‡†åŒ–çš„APIæ¥å£

**ä¸»è¦åŠŸèƒ½ï¼š**
- æ‰‹æŒ‡è§’åº¦æ§åˆ¶
- åŠ›æ§åˆ¶
- é€Ÿåº¦æ§åˆ¶
- çŠ¶æ€ç›‘æ§å’Œé”™è¯¯å¤„ç†

#### `demo_modbus.py`
- Modbus TCPé€šä¿¡ç¤ºä¾‹è„šæœ¬
- æ¼”ç¤ºåŸºæœ¬çš„æ‰‹éƒ¨æ§åˆ¶æ“ä½œ
- åŒ…å«è¿æ¥ã€è®¾ç½®å‚æ•°ã€è¯»å–ä¿¡æ¯ç­‰åŸºç¡€åŠŸèƒ½

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
pip3 install pymodbus==2.5.3
python3 demo_modbus.py
```

#### `library.py`
- ä¸²å£é€šä¿¡åº“
- åº•å±‚æ•°æ®å¤„ç†å‡½æ•°
- æ”¯æŒä¸²å£æ–¹å¼çš„æ‰‹éƒ¨æ§åˆ¶

### 2. æ‰‹åŠ¿è¯†åˆ«é¥æ“ä½œæ¨¡å—

#### `hand_tele.py`
- æ‰‹åŠ¿è¯†åˆ«é¥æ“ä½œç³»ç»Ÿä¸»ç¨‹åº
- é›†æˆMediaPipeæ‰‹éƒ¨æ£€æµ‹
- å®æ—¶æ‰‹åŠ¿åˆ°æœºæ¢°æ‰‹æ˜ å°„
- æ”¯æŒè§¦è§‰åé¦ˆå¯è§†åŒ–

**åŠŸèƒ½ç‰¹ç‚¹ï¼š**
- å®æ—¶æ‰‹éƒ¨å§¿æ€æ£€æµ‹
- æ‰‹åŠ¿åˆ°æœºæ¢°æ‰‹åŠ¨ä½œçš„æ˜ å°„
- è§¦è§‰ä¼ æ„Ÿå™¨æ•°æ®å¯è§†åŒ–
- å¤šçº¿ç¨‹å¤„ç†ç¡®ä¿å®æ—¶æ€§

#### `mp_read_hand.py`
- MediaPipeæ‰‹éƒ¨æ£€æµ‹æ¨¡å—
- æ”¯æŒå·¦æ‰‹ã€å³æ‰‹æˆ–åŒæ‰‹æ£€æµ‹
- æä¾›æ‰‹éƒ¨å…³é”®ç‚¹æ•°æ®
- ä¿å­˜æ‰‹éƒ¨å§¿æ€æ•°æ®åŠŸèƒ½

**ä¸»è¦ç±»å’Œæ–¹æ³•ï¼š**
- `HandDetector`: æ‰‹éƒ¨æ£€æµ‹å™¨ç±»
- æ”¯æŒå®æ—¶æ£€æµ‹å’Œæ•°æ®ä¿å­˜
- å¯é…ç½®æ£€æµ‹ç›®æ ‡ï¼ˆå·¦æ‰‹/å³æ‰‹/åŒæ‰‹ï¼‰

### 3. ä¼ æ„Ÿå™¨æ•°æ®å¯è§†åŒ–æ¨¡å—

#### `read_and_vis_data.py`
- è§¦è§‰ä¼ æ„Ÿå™¨æ•°æ®è¯»å–å’Œå¯è§†åŒ–
- å®æ—¶æ•°æ®ç»˜å›¾
- æ”¯æŒå¤šä¸ªæ‰‹æŒ‡çš„ä¼ æ„Ÿå™¨æ•°æ®

**åŠŸèƒ½ï¼š**
- å®æ—¶è¯»å–è§¦è§‰ä¼ æ„Ÿå™¨æ•°æ®
- æ•°æ®å¯è§†åŒ–ç»˜å›¾
- ä¼ æ„Ÿå™¨çŠ¶æ€ç›‘æ§

#### `touch_data.py`
- è§¦è§‰æ•°æ®å¤„ç†æ¨¡å—
- ä¼ æ„Ÿå™¨æ•°æ®è§£æå’Œå¤„ç†

### 4. ROSä»¿çœŸæ¨¡å—

#### `inspire_hand_left/` ç›®å½•
ROSåŠŸèƒ½åŒ…ï¼ŒåŒ…å«å®Œæ•´çš„å·¦æ‰‹ä»¿çœŸç¯å¢ƒï¼š

**æ–‡ä»¶ç»“æ„ï¼š**
- `urdf/`: æ‰‹éƒ¨çš„URDFæ¨¡å‹æ–‡ä»¶
- `launch/`: ROSå¯åŠ¨æ–‡ä»¶
- `meshes/`: 3Dæ¨¡å‹ç½‘æ ¼æ–‡ä»¶
- `config/`: é…ç½®æ–‡ä»¶

**ä½¿ç”¨æ–¹æ³•ï¼š**

1. **RVIZå¯è§†åŒ–ï¼š**
```bash
roslaunch urdf_left display.launch
```

2. **Gazeboä»¿çœŸï¼š**
```bash
roslaunch urdf_left gazebo.launch
```

3. **ç¨‹åºæ§åˆ¶ï¼š**
```bash
python3 left_hand_control.py
```

**æ§åˆ¶æ–¹å¼ï¼š**
- GUIç•Œé¢æ§åˆ¶
- ROS Topicå‘½ä»¤æ§åˆ¶
- è„šæœ¬è‡ªåŠ¨åŒ–æ§åˆ¶

## ç¡¬ä»¶è¿æ¥å’Œé…ç½®

### ç½‘ç»œè¿æ¥æ–¹å¼ï¼ˆæ¨èï¼‰
1. ä½¿ç”¨ç½‘çº¿è¿æ¥Inspireæ‰‹ä¸ä¸»æœº
2. é…ç½®ç½‘ç»œï¼š
   - IPåœ°å€ï¼š192.168.11.222
   - å­ç½‘æ©ç ï¼š255.255.255.0
3. æµ‹è¯•è¿æ¥ï¼š`ping 192.168.11.210`

### ä¸²å£è¿æ¥æ–¹å¼
1. æŸ¥çœ‹ä¸²å£è®¾å¤‡ï¼šé€šå¸¸ä¸º`/dev/ttyUSB0`æˆ–`/dev/ttyUSB1`
2. ç»™USBç«¯å£æ·»åŠ æ‰§è¡Œæƒé™
3. ä¿®æ”¹ä»£ç ä¸­çš„ç«¯å£é…ç½®

## å®‰è£…ä¾èµ–

### Pythonä¾èµ–
```bash
pip3 install pymodbus==2.5.3
pip3 install opencv-python
pip3 install mediapipe
pip3 install matplotlib
pip3 install numpy
pip3 install pysnooper
```

### ROSä¾èµ–
```bash
sudo apt-get install ros-noetic-joint-state-publisher-gui
sudo apt-get install ros-noetic-robot-state-publisher
sudo apt-get install ros-noetic-gazebo-*
```

## æ§åˆ¶æ¥å£è¯´æ˜

### åŸºç¡€æ§åˆ¶å‘½ä»¤
- `setpos(pos1,pos2,pos3,pos4,pos5,pos6)`: è®¾ç½®é©±åŠ¨å™¨ä½ç½® (èŒƒå›´: -1~2000)
- `setangle(angle1,angle2,angle3,angle4,angle5,angle6)`: è®¾ç½®æ‰‹æŒ‡è§’åº¦ (èŒƒå›´: -1~1000)
- `setpower(power1,power2,power3,power4,power5,power6)`: è®¾ç½®åŠ›æ§é˜ˆå€¼ (èŒƒå›´: 0~1000)
- `setspeed(speed1,speed2,speed3,speed4,speed5,speed6)`: è®¾ç½®é€Ÿåº¦ (èŒƒå›´: 0~1000)

### çŠ¶æ€è¯»å–å‘½ä»¤
- `get_actpos()`: è¯»å–å®é™…ä½ç½®
- `get_actangle()`: è¯»å–å®é™…è§’åº¦
- `get_actforce()`: è¯»å–å®é™…å—åŠ›
- `get_error()`: è¯»å–æ•…éšœä¿¡æ¯
- `get_status()`: è¯»å–çŠ¶æ€ä¿¡æ¯
- `get_temp()`: è¯»å–æ¸©åº¦ä¿¡æ¯
- `get_current()`: è¯»å–ç”µæµä¿¡æ¯

### ç³»ç»Ÿç®¡ç†å‘½ä»¤
- `set_clear_error()`: æ¸…é™¤é”™è¯¯
- `set_save_flash()`: ä¿å­˜å‚æ•°åˆ°Flash
- `set_force_clb()`: æ ¡å‡†åŠ›ä¼ æ„Ÿå™¨

## ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºç¡€æ§åˆ¶ç¤ºä¾‹
```python
from inspire_hand_controller import InspireHandController

# åˆ›å»ºæ§åˆ¶å™¨å®ä¾‹
hand = InspireHandController(ip="192.168.11.210", port=6000)

# è¿æ¥æ‰‹éƒ¨
hand.connect()

# è®¾ç½®æ‰‹æŒ‡è§’åº¦
hand.set_angle([500, 500, 500, 500, 500, 500])

# è¯»å–çŠ¶æ€
status = hand.get_status()
print(f"Hand status: {status}")
```

### 2. æ‰‹åŠ¿é¥æ“ä½œç¤ºä¾‹
```python
from hand_tele import HandTeleoperationSystem

# åˆ›å»ºé¥æ“ä½œç³»ç»Ÿ
tele_system = HandTeleoperationSystem(
    hand_ip="192.168.11.210",
    target_hand="left",
    show_touch_data=True
)

# å¼€å§‹é¥æ“ä½œ
tele_system.start()
```

### 3. ROSæ§åˆ¶ç¤ºä¾‹
```bash
# å¯åŠ¨ä»¿çœŸç¯å¢ƒ
roslaunch urdf_left gazebo.launch

# å‘é€æ§åˆ¶å‘½ä»¤
rostopic pub -r 10 /gripper_controller/command trajectory_msgs/JointTrajectory "
header:
  seq: 0
  stamp: {secs: 0, nsecs: 0}
  frame_id: ''
joint_names: ['left_index_1_joint', 'left_little_1_joint', 'left_middle_1_joint', 'left_ring_1_joint', 'left_thumb_1_joint', 'left_thumb_swing_joint']
points:
  - positions: [1.2, 0.5, 0.5, 0.5, 0.5, 1.08]
    velocities: []
    accelerations: []
    effort: []
    time_from_start: {secs: 1, nsecs: 0}"
```

## æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶å | åŠŸèƒ½è¯´æ˜ |
|--------|----------|
| `inspire_hand_controller.py` | ä¸»æ§åˆ¶å™¨ç±»ï¼Œæä¾›å®Œæ•´çš„æ‰‹éƒ¨æ§åˆ¶API |
| `hand_tele.py` | æ‰‹åŠ¿è¯†åˆ«é¥æ“ä½œä¸»ç¨‹åº |
| `mp_read_hand.py` | MediaPipeæ‰‹éƒ¨æ£€æµ‹æ¨¡å— |
| `read_and_vis_data.py` | è§¦è§‰ä¼ æ„Ÿå™¨æ•°æ®å¯è§†åŒ– |
| `demo_modbus.py` | Modbusé€šä¿¡ç¤ºä¾‹ |
| `library.py` | ä¸²å£é€šä¿¡åº“ |
| `touch_data.py` | è§¦è§‰æ•°æ®å¤„ç† |
| `inspire_hand.py` | åŸºç¡€æ‰‹éƒ¨æ§åˆ¶æ¥å£ |
| `async_read_and_write.py` | å¼‚æ­¥è¯»å†™æ“ä½œ |
| `hand_landmarker.task` | MediaPipeæ‰‹éƒ¨æ£€æµ‹æ¨¡å‹æ–‡ä»¶ |

## å¼€å‘è€…ä¿¡æ¯

- **é¡¹ç›®ç±»å‹**: æœºå™¨äººæ§åˆ¶ç³»ç»Ÿ
- **ç¼–ç¨‹è¯­è¨€**: Python, ROS
- **ç¡¬ä»¶å¹³å°**: Inspireçµå·§æ‰‹
- **é€šä¿¡åè®®**: Modbus TCP, ä¸²å£é€šä¿¡
- **å¯è§†åŒ–**: OpenCV, Matplotlib, RViz, Gazebo

## æ³¨æ„äº‹é¡¹

1. **ç‰ˆæœ¬å…¼å®¹æ€§**: ç¡®ä¿ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬çš„ä¾èµ–åŒ…ï¼Œç‰¹åˆ«æ˜¯`pymodbus==2.5.3`
2. **ç½‘ç»œé…ç½®**: ç½‘ç»œè¿æ¥æ–¹å¼éœ€è¦æ­£ç¡®é…ç½®IPåœ°å€
3. **æƒé™è®¾ç½®**: ä¸²å£è¿æ¥éœ€è¦é€‚å½“çš„è®¾å¤‡æƒé™
4. **å®æ—¶æ€§è¦æ±‚**: é¥æ“ä½œæ¨¡å¼å¯¹ç³»ç»Ÿæ€§èƒ½æœ‰ä¸€å®šè¦æ±‚
5. **å®‰å…¨æ“ä½œ**: æ“ä½œæœºæ¢°æ‰‹æ—¶æ³¨æ„å®‰å…¨ï¼Œé¿å…è¿‡å¤§çš„åŠ›æ§è®¾ç½®

## æ•…éšœæ’é™¤

1. **è¿æ¥é—®é¢˜**: æ£€æŸ¥ç½‘ç»œé…ç½®æˆ–ä¸²å£æƒé™
2. **ä¾èµ–é—®é¢˜**: ç¡®è®¤æ‰€æœ‰PythonåŒ…å’ŒROSåŒ…å·²æ­£ç¡®å®‰è£…
3. **æƒé™é—®é¢˜**: ä¸ºä¸²å£è®¾å¤‡æ·»åŠ ç”¨æˆ·æƒé™
4. **æ€§èƒ½é—®é¢˜**: ç¡®ä¿ç³»ç»Ÿèµ„æºå……è¶³ï¼Œç‰¹åˆ«æ˜¯å®æ—¶æ“ä½œæ¨¡å¼

## æ‰©å±•å¼€å‘

è¯¥é¡¹ç›®æä¾›äº†è‰¯å¥½çš„æ¨¡å—åŒ–ç»“æ„ï¼Œå¯ä»¥è½»æ¾æ‰©å±•ä»¥ä¸‹åŠŸèƒ½ï¼š
- æ›´å¤æ‚çš„æ‰‹åŠ¿è¯†åˆ«ç®—æ³•
- å¤šæ‰‹ååŒæ§åˆ¶
- åŠ›åé¦ˆé›†æˆ
- æœºå™¨å­¦ä¹ é©±åŠ¨çš„æ§åˆ¶ç­–ç•¥
- ä¸å…¶ä»–æœºå™¨äººç³»ç»Ÿçš„é›†æˆ

## åŸå§‹é¡¹ç›®

æœ¬é¡¹ç›®åŸºäº [Lr-2002/inspire_hand](https://github.com/Lr-2002/inspire_hand) è¿›è¡Œäº†æ‰©å±•å’Œæ–‡æ¡£åŒ–ã€‚
