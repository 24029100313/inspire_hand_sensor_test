# Inspire Hand + Isaac Lab é›†æˆé¡¹ç›®çŠ¶æ€

## ğŸš€ **æœ€æ–°è¿›å±• (2025-08-01)**

### âœ… **çŠ¶æ€æœºé‡å¤§é‡å†™å®Œæˆ**

#### 1. åŸºäºå®˜æ–¹lift_cube_sm.pyçš„æ ¸å¿ƒé‡å†™
- **æ–‡ä»¶**: `lift_cube_inspire_hand_state_machine.py` (å®Œå…¨é‡å†™)
- **æ¶æ„**: åŸºäºIsaac Labå®˜æ–¹lift_cube_sm.pyçš„Warp GPUåŠ é€ŸçŠ¶æ€æœº
- **çŠ¶æ€åºåˆ—**: REST â†’ APPROACH_ABOVE_OBJECT â†’ APPROACH_OBJECT â†’ GRASP_OBJECT â†’ LIFT_OBJECT
- **æŠ€æœ¯æ ˆ**: Warpå†…æ ¸GPUå¹¶è¡Œå¤„ç† + è·ç¦»é˜ˆå€¼æ£€æµ‹ + çœŸå®ä½ç½®æ§åˆ¶

#### 2. æ–°å¢åŠŸèƒ½ç‰¹æ€§
- **WarpåŠ é€Ÿ**: GPUå¹¶è¡ŒçŠ¶æ€æœºå¤„ç†ï¼Œæ”¯æŒå¤šç¯å¢ƒ
- **FrameTransformer**: ç«¯æ‰§è¡Œå™¨ä½ç½®è·Ÿè¸ªå’Œå¯è§†åŒ–
- **è·ç¦»æ£€æµ‹**: `distance_below_threshold()` å‡½æ•°æ§åˆ¶çŠ¶æ€è½¬æ¢
- **çŠ¶æ€å¯è§†åŒ–**: å®æ—¶çŠ¶æ€åç§°å’Œç­‰å¾…æ—¶é—´æ˜¾ç¤º
- **ä¼˜åŒ–å‚æ•°**: å¢å¼ºçš„å…³èŠ‚æ§åˆ¶å‚æ•° (stiffness=80.0, damping=4.0)

#### 3. è¿è¡Œè„šæœ¬æ›´æ–°
- **run_state_machine.sh**: çº¯çŠ¶æ€æœºæ¨¡å¼ (æ— MediaPipe)
- **run_with_mediapipe.sh**: æ‰‹åŠ¿æ§åˆ¶æ¨¡å¼
- æ”¯æŒ `--headless` å’Œ `--num_envs` å‚æ•°

### âš ï¸ **å½“å‰å¾…è§£å†³é—®é¢˜**

#### 1. CUDAé©±åŠ¨é—®é¢˜
```
CUDA error 999: unknown error
RuntimeError: CUDA unknown error - this may be due to an incorrectly set up environment
```
- **åŸå› **: CUDAé©±åŠ¨çŠ¶æ€å¼‚å¸¸ï¼Œå¯èƒ½éœ€è¦ç³»ç»Ÿé‡å¯
- **çŠ¶æ€**: GPUæ˜¾ç¤ºç©ºé—²ï¼Œä½†Isaac Labæ— æ³•åˆå§‹åŒ–CUDAä¸Šä¸‹æ–‡
- **è§£å†³æ–¹æ¡ˆ**: ç³»ç»Ÿé‡å¯åé‡æ–°æµ‹è¯•

#### 2. APIå…¼å®¹æ€§é—®é¢˜ (å·²è§£å†³)
- **é—®é¢˜**: `FrameTransformerCfg.FrameVisualizerCfg` APIä¸å­˜åœ¨
- **è§£å†³**: ç®€åŒ–ä¸º `debug_vis=False` é…ç½®

### ğŸ“‹ **ä¸‹æ¬¡å¯åŠ¨åçš„æµ‹è¯•è®¡åˆ’**

#### Phase 1: åŸºç¡€éªŒè¯
```bash
# 1. ç¡®è®¤CUDAçŠ¶æ€
nvidia-smi

# 2. æµ‹è¯•çŠ¶æ€æœº (headlessæ¨¡å¼)
./run_state_machine.sh --headless

# 3. æµ‹è¯•çŠ¶æ€æœº (å¯è§†åŒ–æ¨¡å¼)
./run_state_machine.sh
```

#### Phase 2: åŠŸèƒ½éªŒè¯
- éªŒè¯5çŠ¶æ€æŠ“å–åºåˆ—æ˜¯å¦æ­£å¸¸è¿è¡Œ
- æ£€æŸ¥æ‰‹æŒ‡å…³èŠ‚æ§åˆ¶æ˜¯å¦å“åº”çŠ¶æ€æœºæŒ‡ä»¤
- ç¡®è®¤cubeä½ç½®å’Œæ‰‹éƒ¨ä½ç½®çš„è·ç¦»æ£€æµ‹
- è§‚å¯ŸçŠ¶æ€è½¬æ¢æ—¶æœºå’Œç­‰å¾…æ—¶é—´

#### Phase 3: æ€§èƒ½ä¼˜åŒ–
- è°ƒè¯•æ‰‹æŒ‡æŠ“å–å‚æ•° (å¦‚æœæŠ“å–ä¸ç¨³å®š)
- ä¼˜åŒ–çŠ¶æ€è½¬æ¢é˜ˆå€¼ (position_threshold=0.03)
- æµ‹è¯•å¤šç¯å¢ƒå¹¶è¡Œ (`--num_envs 4`)

### ğŸ”§ **æŠ€æœ¯å®ç°è¦ç‚¹**

#### çŠ¶æ€æœºæ ¸å¿ƒé€»è¾‘
```python
@wp.kernel
def infer_state_machine(...):
    # GPUå¹¶è¡Œå¤„ç†æ¯ä¸ªç¯å¢ƒçš„çŠ¶æ€è½¬æ¢
    # åŸºäºè·ç¦»é˜ˆå€¼å’Œç­‰å¾…æ—¶é—´çš„çŠ¶æ€æœº
```

#### å…³é”®æ”¹è¿›ç‚¹
1. **çœŸå®ä½ç½®æ§åˆ¶**: ä¸å†åªæ˜¯æ‰‹æŒ‡å¼€åˆï¼Œè€Œæ˜¯æ•´ä½“ç©ºé—´è¿åŠ¨
2. **è·ç¦»é˜ˆå€¼æ£€æµ‹**: ç²¾ç¡®çš„ä½ç½®åˆ°è¾¾åˆ¤æ–­
3. **Warp GPUåŠ é€Ÿ**: æ”¯æŒå¤§è§„æ¨¡å¹¶è¡Œç¯å¢ƒ
4. **çŠ¶æ€æŒä¹…åŒ–**: åˆç†çš„ç­‰å¾…æ—¶é—´é¿å…çŠ¶æ€æŠ–åŠ¨

## âœ… å·²å®Œæˆçš„æ ¸å¿ƒç»„ä»¶

### 1. ä¸»ç¨‹åºæ–‡ä»¶
- **lift_cube_inspire_hand.py** (17KB)
  - Isaac Labç¯å¢ƒé…ç½®
  - MediaPipeæ§åˆ¶å™¨é›†æˆ  
  - 1061ä¸ªä¼ æ„Ÿå™¨ç®¡ç†å™¨
  - å®Œæ•´çš„ä»¿çœŸå¾ªç¯

### 2. å¯åŠ¨è„šæœ¬
- **run_inspire_hand_grasp.sh** (å¯æ‰§è¡Œ)
  - è‡ªåŠ¨æ£€æŸ¥ä¾èµ–å’Œæ–‡ä»¶
  - å‚æ•°é…ç½®å’Œé”™è¯¯å¤„ç†
  - ä¸€é”®å¯åŠ¨ç³»ç»Ÿ

### 3. æŠ€æœ¯æ–‡æ¡£
- **inspire_hand_isaac_lab_integration_summary.txt** (5.7KB)
  - å®Œæ•´æŠ€æœ¯æ ˆæ€»ç»“
  - å®ç°æ–¹æ¡ˆå’Œæ¶æ„è®¾è®¡

## ğŸ”§ æ ¸å¿ƒæŠ€æœ¯é›†æˆ

### MediaPipeæ§åˆ¶ç³»ç»Ÿ
```python
# å®æ—¶æ‰‹åŠ¿è¯†åˆ« â†’ è§’åº¦è½¬æ¢ â†’ Isaac Labæ§åˆ¶
inspire_values = detector.convert_fingure_to_inspire(landmarks[0])
command = torch.tensor([...])  # 6ä¸ªå…³èŠ‚æ§åˆ¶ä¿¡å·
```

### 1061ä¼ æ„Ÿå™¨é…ç½®
```python
# 17ä¸ªä¼ æ„Ÿå™¨ç»„ï¼Œæ€»è®¡1061ä¸ªsensor pad
sensor_groups = {
    "palm_sensor": {"count": 112},
    "thumb_sensor_1": {"count": 96},
    ...
}
```

### Isaac Labç¯å¢ƒ
```python
# Inspire Hand USDæ–‡ä»¶é›†æˆ
usd_path="/path/to/inspire_hand_processed_with_pads.usd"
# 6è‡ªç”±åº¦å…³èŠ‚æ§åˆ¶
joint_names=["left_index_1_joint", "left_little_1_joint", ...]
```

## ğŸ“¦ é¡¹ç›®ä¾èµ–

### å·²éªŒè¯çš„æ¨¡å—
- âœ… mp_read_hand.py - MediaPipeæ‰‹åŠ¿è¯†åˆ«
- âœ… inspire_hand_controller.py - åŸå§‹æ§åˆ¶å™¨
- âœ… hand_landmarker.task - MediaPipeæ¨¡å‹æ–‡ä»¶

### å¤–éƒ¨ä¾èµ–ï¼ˆéœ€è¦åœ¨Isaac Labç¯å¢ƒä¸­å®‰è£…ï¼‰
- OpenCV (cv2) - æ‘„åƒå¤´å¤„ç†
- MediaPipe - æ‰‹åŠ¿è¯†åˆ«
- PyTorch - å¼ é‡è®¡ç®—
- Isaac Lab - æœºå™¨äººä»¿çœŸ

## ğŸ¯ å…³é”®ç‰¹æ€§

### 1. åŒæ¨¡å¼æ§åˆ¶
- **MediaPipeæ¨¡å¼**: å®æ—¶æ‰‹åŠ¿æ˜ å°„æ§åˆ¶
- **è‡ªåŠ¨æ¨¡å¼**: é¢„è®¾æŠ“å–åºåˆ—

### 2. é«˜å¯†åº¦ä¼ æ„Ÿå™¨
- **1061ä¸ªè§¦è§‰pad**: æç²¾ç»†çš„è§¦è§‰æ„ŸçŸ¥
- **å®æ—¶åŠ›åé¦ˆ**: æ¯æ­¥æ˜¾ç¤ºæ¥è§¦çŠ¶æ€
- **å®‰å…¨æ§åˆ¶**: è¿‡åŠ›æ£€æµ‹å’Œä¿æŠ¤

### 3. æ ‡å‡†åŒ–é›†æˆ
- **Isaac Labæ¡†æ¶**: æ ‡å‡†çš„æœºå™¨äººç¯å¢ƒ
- **USDæ ¼å¼**: é«˜æ€§èƒ½çš„3Dèµ„äº§
- **PyTorchåç«¯**: GPUåŠ é€Ÿè®¡ç®—

## ğŸš€ ä¸‹ä¸€æ­¥æµ‹è¯•

### ç¯å¢ƒå‡†å¤‡
1. ç¡®ä¿Isaac Labç¯å¢ƒæ¿€æ´»
2. å®‰è£…MediaPipeä¾èµ–: `pip install opencv-python mediapipe`
3. æ£€æŸ¥USDæ–‡ä»¶è·¯å¾„

### è¿è¡Œæµ‹è¯•
```bash
# å¯åŠ¨å®Œæ•´ç³»ç»Ÿ
./run_inspire_hand_grasp.sh

# æ— å¤´æ¨¡å¼æµ‹è¯•
./run_inspire_hand_grasp.sh --headless

# å¤šç¯å¢ƒå¹¶è¡Œ
./run_inspire_hand_grasp.sh --num_envs 4
```

### é¢„æœŸè¾“å‡º
- Isaac Simçª—å£æ˜¾ç¤ºInspire Handå’Œç«‹æ–¹ä½“
- MediaPipeçª—å£æ˜¾ç¤ºæ‰‹åŠ¿è¯†åˆ«
- ç»ˆç«¯è¾“å‡º1061ä¸ªä¼ æ„Ÿå™¨çš„åŠ›æ•°æ®
- å®æ—¶æ‰‹åŠ¿æ§åˆ¶inspire handæŠ“å–åŠ¨ä½œ

## ï¿½ï¿½ é¡¹ç›®æˆå°±

è¿™æ˜¯ä¸€ä¸ª**ä¸–ç•Œçº§çš„æœºå™¨äººè§¦è§‰æ„ŸçŸ¥ç³»ç»Ÿ**ï¼Œç»“åˆäº†ï¼š
- **æœ€å…ˆè¿›çš„è§†è§‰æ„ŸçŸ¥** (MediaPipe)
- **æœ€å¯†é›†çš„è§¦è§‰ä¼ æ„Ÿå™¨** (1061 pads)  
- **æœ€é«˜æ€§èƒ½çš„ä»¿çœŸ** (Isaac Lab + GPU)
- **æœ€è‡ªç„¶çš„äº¤äº’æ–¹å¼** (æ‰‹åŠ¿æ§åˆ¶)

æ€»è®¡ä»£ç é‡ï¼šçº¦**40KB**ï¼Œé›†æˆäº†å¤šé¡¹å‰æ²¿æŠ€æœ¯ï¼
